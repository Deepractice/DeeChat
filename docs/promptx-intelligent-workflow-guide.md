# PromptXæ™ºèƒ½å·¥ä½œæµä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

DeeChatå·²é›†æˆPromptXè®¤çŸ¥å¢å¼ºç³»ç»Ÿï¼Œé€šè¿‡æ™ºèƒ½å·¥ä½œæµè®©AIèƒ½å¤Ÿè‡ªåŠ¨æ£€æµ‹ç”¨æˆ·æ„å›¾å¹¶è°ƒç”¨åˆé€‚çš„PromptXå·¥å…·ï¼Œå®ç°çœŸæ­£çš„"ç”¨æˆ·æ— æ„Ÿ"ä¸“ä¸šæœåŠ¡ã€‚

## æ ¸å¿ƒç‰¹æ€§

### 1. ğŸ¤– æ™ºèƒ½æ„å›¾æ£€æµ‹
- è‡ªåŠ¨è¯†åˆ«ç”¨æˆ·éœ€æ±‚ç±»å‹
- æ— éœ€ç”¨æˆ·äº†è§£å·¥å…·åç§°
- åŸºäºè‡ªç„¶è¯­è¨€ç†è§£

### 2. ğŸ“‹ å·¥ä½œæµè‡ªåŠ¨ç¼–æ’
- æ ¹æ®æ„å›¾è‡ªåŠ¨ç»„åˆå·¥å…·
- ä¼˜åŒ–æ‰§è¡Œé¡ºåº
- é¿å…å†—ä½™æ“ä½œ

### 3. ğŸ¯ é€æ˜åŒ–è°ƒç”¨
- ç”¨æˆ·æ„ŸçŸ¥ä¸åˆ°æŠ€æœ¯ç»†èŠ‚
- è‡ªç„¶æµç•…çš„å¯¹è¯ä½“éªŒ
- æ™ºèƒ½åé¦ˆå’Œå¼•å¯¼

## æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç”¨æˆ·è¾“å…¥                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ„å›¾æ£€æµ‹å±‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚è§’è‰²éœ€æ±‚ â”‚ â”‚è®°å¿†éœ€æ±‚ â”‚ â”‚æ€è€ƒéœ€æ±‚ â”‚ ...      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å†³ç­–åˆ¤æ–­å±‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚å·¥å…·é€‰æ‹© â”‚ â”‚è§’è‰²æ¨è â”‚ â”‚å·¥ä½œæµç¼–æ’â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ‰§è¡Œåé¦ˆå±‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚å·¥å…·æ‰§è¡Œ â”‚ â”‚ç»“æœæ ¼å¼åŒ–â”‚ â”‚ç”¨æˆ·åé¦ˆ â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ä½¿ç”¨æ–¹å¼

### 1. åŸºç¡€é›†æˆ

```typescript
import { LLMService } from '@/services/llm/LLMService';
import { PROMPTX_SYSTEM_PROMPT } from '@/shared/prompts/PromptXSystemPrompt';

// LLMServiceå·²è‡ªåŠ¨é›†æˆPromptXç³»ç»Ÿæç¤ºè¯
const llmService = new LLMService();

// å‘é€æ¶ˆæ¯æ—¶ä¼šè‡ªåŠ¨æ£€æµ‹æ„å›¾
const response = await llmService.sendMessage({
  message: "å¸®æˆ‘å¼€å‘ä¸€ä¸ªè®¡ç®—å™¨å·¥å…·",
  systemPrompt: PROMPTX_SYSTEM_PROMPT // å¯é€‰ï¼Œå·²é»˜è®¤é›†æˆ
}, modelId);
```

### 2. é«˜çº§ç”¨æ³•ï¼ˆä½¿ç”¨LangChainï¼‰

```typescript
import { createPromptXEnhancedChat } from '@/shared/langchain/PromptXEnhancedChain';
import { ChatOpenAI } from "@langchain/openai";

// åˆ›å»ºå¢å¼ºçš„èŠå¤©é“¾
const llm = new ChatOpenAI({ modelName: "gpt-4" });
const chain = createPromptXEnhancedChat(llm);

// è°ƒç”¨æ—¶è¿”å›å»ºè®®çš„å·¥ä½œæµ
const result = await chain.invoke({
  input: "æˆ‘æƒ³å­¦ä¹ æœºå™¨å­¦ä¹ ",
  chat_history: []
});

console.log("AIå“åº”:", result.response);
console.log("å»ºè®®çš„PromptXæ“ä½œ:", result.promptx_actions);
console.log("å®Œæ•´å·¥ä½œæµ:", result.suggested_workflow);
```

## æ„å›¾æ£€æµ‹ç¤ºä¾‹

### è§’è‰²æ¿€æ´»

```
ç”¨æˆ·è¾“å…¥: "å¸®æˆ‘å¼€å‘ä¸€ä¸ªç½‘ç«™"
æ£€æµ‹ç»“æœ: 
- æ„å›¾ç±»å‹: role
- å»ºè®®è§’è‰²: luban (å·¥å…·å¼€å‘ä¸“å®¶)
- ç½®ä¿¡åº¦: 0.85
- å·¥ä½œæµ: promptx_action(luban) â†’ promptx_learn â†’ promptx_tool
```

### è®°å¿†æ“ä½œ

```
ç”¨æˆ·è¾“å…¥: "è®°ä½æˆ‘å–œæ¬¢ä½¿ç”¨Reactæ¡†æ¶"
æ£€æµ‹ç»“æœ:
- æ„å›¾ç±»å‹: memory
- å»ºè®®æ“ä½œ: promptx_remember
- ç½®ä¿¡åº¦: 0.9
- å·¥ä½œæµ: promptx_remember(user_preference)
```

### æ·±åº¦æ€è€ƒ

```
ç”¨æˆ·è¾“å…¥: "å¸®æˆ‘æ·±å…¥åˆ†æè¿™ä¸ªæ¶æ„çš„ä¼˜ç¼ºç‚¹"
æ£€æµ‹ç»“æœ:
- æ„å›¾ç±»å‹: thinking
- å»ºè®®æ“ä½œ: promptx_think
- ç½®ä¿¡åº¦: 0.8
- å·¥ä½œæµ: promptx_recall â†’ promptx_think â†’ promptx_remember
```

## å·¥ä½œæµæ¨¡æ¿

### 1. å¼€å‘å·¥å…·å·¥ä½œæµ
```javascript
[
  { tool: 'promptx_action', params: { role: 'luban' } },
  { tool: 'promptx_learn', params: { resource: '@manual://tool-development' } },
  { tool: 'promptx_think', params: { pattern: 'systematic' } },
  { tool: 'promptx_tool', params: { /* åŠ¨æ€å‚æ•° */ } },
  { tool: 'promptx_remember', params: { /* è®°å¿†ç»“æœ */ } }
]
```

### 2. å­¦ä¹ çŸ¥è¯†å·¥ä½œæµ
```javascript
[
  { tool: 'promptx_action', params: { role: 'noface' } },
  { tool: 'promptx_learn', params: { /* åŠ¨æ€èµ„æº */ } },
  { tool: 'promptx_think', params: { pattern: 'analytical' } },
  { tool: 'promptx_remember', params: { /* æ ¸å¿ƒæ¦‚å¿µ */ } }
]
```

### 3. å›å¿†ä¿¡æ¯å·¥ä½œæµ
```javascript
[
  { tool: 'promptx_recall', params: { /* æŸ¥è¯¢å…³é”®è¯ */ } },
  { tool: 'promptx_think', params: { pattern: 'reasoning' } }
]
```

## æœ€ä½³å®è·µ

### 1. ç³»ç»Ÿæç¤ºè¯é…ç½®

åœ¨åˆ›å»ºæ–°ä¼šè¯æ—¶ï¼Œç¡®ä¿ä½¿ç”¨PromptXç³»ç»Ÿæç¤ºè¯ï¼š

```typescript
import { PROMPTX_SYSTEM_PROMPT } from '@/shared/prompts/PromptXSystemPrompt';

// æ–¹å¼1ï¼šç›´æ¥ä½¿ç”¨
const systemPrompt = PROMPTX_SYSTEM_PROMPT;

// æ–¹å¼2ï¼šè‡ªå®šä¹‰æ‰©å±•
const customPrompt = `
${PROMPTX_SYSTEM_PROMPT}

# é¡¹ç›®ç‰¹å®šè§„åˆ™
- ä¼˜å…ˆä½¿ç”¨TypeScript
- éµå¾ªå…¬å¸ä»£ç è§„èŒƒ
`;
```

### 2. æ„å›¾æ£€æµ‹ä¼˜åŒ–

```typescript
import { promptXIntentDetector } from '@/shared/services/PromptXIntentDetector';

// æ£€æµ‹ç”¨æˆ·æ„å›¾
const intent = promptXIntentDetector.detectIntent(userInput, {
  currentRole: 'assistant',
  memoryHistory: previousMemories
});

// æ ¹æ®ç½®ä¿¡åº¦å†³å®šæ˜¯å¦æ‰§è¡Œ
if (intent && intent.confidence > 0.7) {
  // æ‰§è¡Œå»ºè®®çš„PromptXæ“ä½œ
  console.log(`å»ºè®®æ‰§è¡Œ: ${intent.suggestedAction.tool}`);
}
```

### 3. å·¥ä½œæµç¼–æ’

```typescript
import { promptXWorkflowOrchestrator } from '@/shared/services/PromptXWorkflowOrchestrator';

// ç¼–æ’å·¥ä½œæµ
const workflow = promptXWorkflowOrchestrator.orchestrateWorkflow(intent, context);

// ä¼˜åŒ–å·¥ä½œæµï¼ˆå»é™¤å†—ä½™ï¼‰
const optimizedWorkflow = promptXWorkflowOrchestrator.optimizeWorkflow(workflow, context);
```

## æ³¨æ„äº‹é¡¹

1. **æ€§èƒ½è€ƒè™‘**
   - æ„å›¾æ£€æµ‹æ˜¯è½»é‡çº§æ“ä½œï¼Œä¸ä¼šæ˜¾è‘—å½±å“å“åº”æ—¶é—´
   - å·¥ä½œæµç¼–æ’åœ¨å®¢æˆ·ç«¯å®Œæˆï¼Œä¸å¢åŠ ç½‘ç»œå¼€é”€

2. **éšç§ä¿æŠ¤**
   - æ‰€æœ‰PromptXå·¥å…·è°ƒç”¨éƒ½åœ¨æœ¬åœ°æ²™ç®±ä¸­æ‰§è¡Œ
   - è®°å¿†ç³»ç»Ÿæ•°æ®å­˜å‚¨åœ¨ç”¨æˆ·æœ¬åœ°

3. **é™çº§ç­–ç•¥**
   - å¦‚æœPromptXæœåŠ¡ä¸å¯ç”¨ï¼Œè‡ªåŠ¨é™çº§ä¸ºæ™®é€šAIå¯¹è¯
   - ä¿æŒåŸºç¡€åŠŸèƒ½å¯ç”¨æ€§

4. **è°ƒè¯•æ¨¡å¼**
   - è®¾ç½® `verbose: true` å¯ä»¥çœ‹åˆ°è¯¦ç»†çš„æ„å›¾æ£€æµ‹å’Œå·¥ä½œæµä¿¡æ¯
   - æœ‰åŠ©äºä¼˜åŒ–æ„å›¾æ£€æµ‹è§„åˆ™

## æ‰©å±•å¼€å‘

### æ·»åŠ æ–°çš„æ„å›¾æ¨¡å¼

```typescript
// åœ¨ PromptXSystemPrompt.ts ä¸­æ·»åŠ 
export const INTENT_PATTERNS = {
  // ... ç°æœ‰æ¨¡å¼
  
  // æ·»åŠ è‡ªå®šä¹‰æ¨¡å¼
  customPattern: {
    myFeature: [
      /ç‰¹å¾è¯1/i,
      /ç‰¹å¾è¯2/i
    ]
  }
};
```

### è‡ªå®šä¹‰å·¥ä½œæµæ¨¡æ¿

```typescript
// åœ¨ PromptXWorkflowOrchestrator.ts ä¸­æ·»åŠ 
private createCustomWorkflow(intent: DetectedIntent, context: WorkflowContext): WorkflowStep[] {
  return [
    { tool: 'promptx_action', params: { role: 'custom-role' } },
    { tool: 'promptx_learn', params: { resource: '@custom://resource' } },
    // ... æ›´å¤šæ­¥éª¤
  ];
}
```

## æ€»ç»“

PromptXæ™ºèƒ½å·¥ä½œæµç³»ç»Ÿè®©DeeChatçš„AIåŠ©æ‰‹èƒ½å¤Ÿï¼š

1. âœ… è‡ªåŠ¨ç†è§£ç”¨æˆ·æ„å›¾
2. âœ… æ™ºèƒ½é€‰æ‹©å’Œç»„åˆå·¥å…·
3. âœ… æä¾›ä¸“ä¸šåŒ–æœåŠ¡
4. âœ… ä¿æŒå¯¹è¯çš„è‡ªç„¶æµç•…
5. âœ… è®°å¿†é‡è¦ä¿¡æ¯è·¨ä¼šè¯ä¿æŒ

é€šè¿‡è¿™å¥—ç³»ç»Ÿï¼Œç”¨æˆ·æ— éœ€äº†è§£PromptXçš„æŠ€æœ¯ç»†èŠ‚ï¼Œå°±èƒ½äº«å—åˆ°å¼ºå¤§çš„AIè®¤çŸ¥å¢å¼ºèƒ½åŠ›ã€‚